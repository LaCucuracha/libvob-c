// (c): Matti Katila

#include <math.h>

#include "util/rng.h"
#include "util/test.h"


/*
scala> r.setSeed(0)
scala> for (i <- 0 to 10) { println(r.nextDouble) }
0.730967787376657
0.24053641567148587
0.6374174253501083
0.5504370051176339
0.5975452777972018
0.3332183994766498
0.3851891847407185
0.984841540199809
0.8791825178724801
0.9412491794821144
0.27495396603548483


scala> r.setSeed(0)
scala> for (i <- 0 to 10) { println(r.nextGaussian) }
0.8025330637390305
-0.9015460884175122
2.080920790428163
0.7637707684364894
0.9845745328825128
-1.6834122587673428
-0.027290262907887285
0.11524570286202315
-0.39016704137993785
-0.6433888131264491
0.052460907198835775


*/

void test_rng_gaussian()
{
	double tests[] = {
		0.8025330637390305, -0.9015460884175122,
		2.080920790428163, 0.7637707684364894,
		0.9845745328825128, -1.6834122587673428,
		-0.027290262907887285, 0.11524570286202315,
		-0.39016704137993785, -0.6433888131264491,
		0.052460907198835775, 0.5213420769298895,
		-0.8239670026881707, 0.26071819402835644,
		-0.4529877558422544, 1.4031473817209366,
		0.27113061707020236, -0.007054015349837401,
		0.9049586994113287, 0.8568542481006806,
		0.3723340814425109, 0.3976728390023819
	};
	int i;
	double eps = 1E-12;

	util_rng_set_seed(0LL);
	for (i=0; i<(sizeof(tests)/sizeof(double)); i++) {
		assert_true( fabs(tests[i] - util_rng_next_gaussian()) < eps );
	}
}

void test_rng_double()
{
	double tests[] = {
		0.730967787376657, 0.24053641567148587,
		0.6374174253501083, 0.5504370051176339,
		0.5975452777972018, 0.3332183994766498,
		0.3851891847407185, 0.984841540199809,
		0.8791825178724801, 0.9412491794821144,
		0.27495396603548483, 0.12889715087377673,
		0.14660165764651822, 0.023238122483889456,
		0.5467397571984656, 0.9644868606768501,
		0.10449068625097169, 0.6251463634655593,
		0.4107961954910617, 0.7763122912749325,
		0.990722785714783, 0.4872328470301428
	};
	int i;
	double eps = 1E-12;

	util_rng_set_seed(0LL);
	for (i=0; i<(sizeof(tests)/sizeof(double)); i++) {
		assert_true( fabs(tests[i] - util_rng_next_double()) < eps );
	}
}

void test_rng_int()
{
	double tests[] = {
		-1155484576, -723955400,
		1033096058, -1690734402,
		-1557280266, 1327362106,
		-1930858313, 502539523,
		-1728529858, -938301587,
		1431162155, 1085665355,
		1654374947, -1661998771,
		-65105105, -73789608,
		-518907128, 99135751,
		-252332814, 755814641,
		1180918287, 1344049776
	};
	int i;

	util_rng_set_seed(0LL);
	for (i=0; i<(sizeof(tests)/sizeof(double)); i++) {
		assert_true(tests[i] == util_rng_next_int());
	}
}
